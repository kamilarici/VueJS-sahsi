"use strict";(self["webpackChunk_17_playlist_uygulamma_6"]=self["webpackChunk_17_playlist_uygulamma_6"]||[]).push([[335],{1434:function(e,l,t){var a=t(7732),n=t(4870),s=t(9944);const{user:o}=(0,s.Z)(),i=()=>{const e=(0,n.iH)(null),l=(0,n.iH)(null),t=(0,n.iH)(null),s=async n=>{t.value=`covers/${o.value.uid}/${n.name}`;const s=a.vY.ref(t.value);try{const e=await s.put(n);l.value=await e.ref.getDownloadURL()}catch(err){console.log(err.message),e.value=err.message}},i=async l=>{const t=a.vY.ref(l);try{await t.delete()}catch(e){console.log(err.message),e.value=err.message}};return{uploadImage:s,url:l,filePath:t,error:e,deleteImage:i}};l.Z=i},2335:function(e,l,t){t.r(l),t.d(l,{default:function(){return x}});var a=t(3396),n=t(7139);const s={key:0,class:"error"},o={key:1,class:"playlist-details"},i={class:"playlist-info"},r={class:"cover"},u=["src"],c={class:"username"},d={class:"description"},p={class:"song-list"},v={key:0},g={class:"details"},y=["onClick"];function h(e,l,t,h,w,m){const k=(0,a.up)("AddSong");return(0,a.wg)(),(0,a.iD)("div",null,[h.error?((0,a.wg)(),(0,a.iD)("div",s,(0,n.zw)(h.error),1)):(0,a.kq)("",!0),h.playlist?((0,a.wg)(),(0,a.iD)("div",o,[(0,a._)("div",i,[(0,a._)("div",r,[(0,a._)("img",{src:h.playlist.coverUrl},null,8,u)]),(0,a._)("h2",null,(0,n.zw)(h.playlist.title),1),(0,a._)("p",c,"Created by "+(0,n.zw)(h.playlist.userName),1),(0,a._)("p",d,(0,n.zw)(h.playlist.description),1),h.ownership?((0,a.wg)(),(0,a.iD)("button",{key:0,onClick:l[0]||(l[0]=(...e)=>h.handleDelete&&h.handleDelete(...e))},"Delete")):(0,a.kq)("",!0)]),(0,a._)("div",p,[h.playlist.songs.length?((0,a.wg)(),(0,a.iD)("div",v,"no songs have been added yet.")):(0,a.kq)("",!0),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(h.playlist.songs,(e=>((0,a.wg)(),(0,a.iD)("div",{key:e.id,class:"single-song"},[(0,a._)("div",g,[(0,a._)("h3",null,(0,n.zw)(e.title),1),(0,a._)("p",null,(0,n.zw)(e.artist),1)]),h.ownership?((0,a.wg)(),(0,a.iD)("button",{key:0,onClick:l=>h.handleClick(e.id)},"Delete",8,y)):(0,a.kq)("",!0)])))),128)),h.ownership?((0,a.wg)(),(0,a.j4)(k,{key:1,playlist:h.playlist},null,8,["playlist"])):(0,a.kq)("",!0)])])):(0,a.kq)("",!0)])}t(7658);var w=t(1434),m=t(4870),k=t(7732);const D=(e,l)=>{let t=(0,m.iH)(null),a=(0,m.iH)(!1),n=k.H1.collection(e).doc(l);const s=async()=>{a.value=!0,t.value=null;try{const e=await n.delete();return a.value=!1,e}catch(err){console.log(err.message),a.value=!1,t.value="could not delete the document"}},o=async e=>{a.value=!0,t.value=null;try{const l=await n.update(e);return a.value=!1,l}catch(err){console.log(err.message),a.value=!1,t.value="could not update the document"}};return{error:t,isPending:a,deleteDoc:s,updateDoc:o}};var _=D;const f=(e,l)=>{const t=(0,m.iH)(null),a=(0,m.iH)(null);let n=k.H1.collection(e).doc(l);return n.onSnapshot((e=>{e.data()?(t.value={...e.data(),id:e.id},a.value=null):a.value="document not fetch data",a.value=null}),(e=>{console.log(e.message),a.value="could not fetch data"})),{document:t,error:a}};var H=f,b=t(9944),q=t(2483),S=t(9242);const C={class:"add-song"},z=(0,a._)("h4",null,"Add a New Song",-1),A=(0,a._)("button",null,"Add",-1);function Z(e,l,t,n,s,o){return(0,a.wg)(),(0,a.iD)("div",C,[n.showForm?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("button",{key:0,onClick:l[0]||(l[0]=e=>n.showForm=!0)},"Add Song")),n.showForm?((0,a.wg)(),(0,a.iD)("form",{key:1,onSubmit:l[3]||(l[3]=(0,S.iM)(((...e)=>n.handleSubmit&&n.handleSubmit(...e)),["prevent"]))},[z,(0,a.wy)((0,a._)("input",{type:"text",placeholder:"Song Title",required:"","onUpdate:modelValue":l[1]||(l[1]=e=>n.title=e)},null,512),[[S.nr,n.title]]),(0,a.wy)((0,a._)("input",{type:"text",placeholder:"Artist",required:"","onUpdate:modelValue":l[2]||(l[2]=e=>n.artist=e)},null,512),[[S.nr,n.artist]]),A],32)):(0,a.kq)("",!0)])}var F={props:["playlist"],setup(e){const l=(0,m.iH)(""),t=(0,m.iH)(""),a=(0,m.iH)(!1),{updateDoc:n}=_("playlists",e.playlist.id),s=async()=>{const a={title:l.value,artist:t.value,id:Math.floor(1e6*Math.random())};await n({songs:[...e.playlist.songs,a]}),l.value="",t.value=""};return{title:l,artist:t,showForm:a,handleSubmit:s}}},I=t(89);const U=(0,I.Z)(F,[["render",Z]]);var M=U,P={props:["id"],components:{AddSong:M},setup(e){const{error:l,document:t}=H("playlists",e.id),{user:n}=(0,b.Z)(),{deleteDoc:s,updateDoc:o}=_("playlists",e.id),{deleteImage:i}=(0,w.Z)(),r=(0,q.tv)(),u=(0,a.Fl)((()=>t.value&&n.value&&n.value.uid===t.value.userId)),c=async()=>{await i(t.value.filePath),await s(),r.push({name:"home"})},d=async e=>{const l=t.value.songs.filter((l=>l.id!==e));await o({songs:l})};return{error:l,playlist:t,ownership:u,handleDelete:c,handleClick:d}}};const Y=(0,I.Z)(P,[["render",h]]);var x=Y}}]);
//# sourceMappingURL=335.f8efe5ee.js.map